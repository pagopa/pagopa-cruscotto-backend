<?xml version="1.0" encoding="utf-8"?>
<databaseChangeLog
  xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
  xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.5.xsd
                        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

  <changeSet id="20251016120001-1" author="system" context="dml">
	<validCheckSum>ANY</validCheckSum>
	<comment>Add KPI B8 authorizations for result, detail result and analytic data APIs</comment>
	<sql splitStatements="true" stripComments="true">

	  <!-- Insert KPI B8 permissions -->
	  INSERT INTO ${database.defaultSchemaName}.AUTH_PERMISSION (co_id, te_nome, te_modulo) VALUES(10086, 'KPI_B8_RESULT_DETAIL', 'GTW');
	  INSERT INTO ${database.defaultSchemaName}.AUTH_PERMISSION (co_id, te_nome, te_modulo) VALUES(10087, 'KPI_B8_DETAIL_RESULT_DETAIL', 'GTW');
	  INSERT INTO ${database.defaultSchemaName}.AUTH_PERMISSION (co_id, te_nome, te_modulo) VALUES(10088, 'KPI_B8_ANALITIC_DATA_DETAIL', 'GTW');

	  <!-- Associate permissions with function 10008 (KPI function) -->
	  INSERT INTO ${database.defaultSchemaName}.AUTH_FUN_AUTH_PERM (co_auth_permission_id, co_auth_function_id) VALUES(10086, 10004);
	  INSERT INTO ${database.defaultSchemaName}.AUTH_FUN_AUTH_PERM (co_auth_permission_id, co_auth_function_id) VALUES(10087, 10004);
	  INSERT INTO ${database.defaultSchemaName}.AUTH_FUN_AUTH_PERM (co_auth_permission_id, co_auth_function_id) VALUES(10088, 10004);

	</sql>
	<rollback>

	  <!-- Remove function-permission associations -->
	  DELETE FROM ${database.defaultSchemaName}.AUTH_FUN_AUTH_PERM WHERE co_auth_permission_id = 10086 AND co_auth_function_id = 10004;
	  DELETE FROM ${database.defaultSchemaName}.AUTH_FUN_AUTH_PERM WHERE co_auth_permission_id = 10087 AND co_auth_function_id = 10004;
	  DELETE FROM ${database.defaultSchemaName}.AUTH_FUN_AUTH_PERM WHERE co_auth_permission_id = 10088 AND co_auth_function_id = 10004;

	  <!-- Remove permissions -->
	  DELETE FROM ${database.defaultSchemaName}.AUTH_PERMISSION WHERE co_id = 10086;
	  DELETE FROM ${database.defaultSchemaName}.AUTH_PERMISSION WHERE co_id = 10087;
	  DELETE FROM ${database.defaultSchemaName}.AUTH_PERMISSION WHERE co_id = 10088;

	</rollback>
  </changeSet>

</databaseChangeLog>
