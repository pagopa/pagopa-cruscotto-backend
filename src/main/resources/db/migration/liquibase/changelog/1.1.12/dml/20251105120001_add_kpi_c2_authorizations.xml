<?xml version="1.0" encoding="utf-8"?>
<databaseChangeLog
  xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
  xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.5.xsd
                        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

  <changeSet id="20251105120001-1" author="system" context="dml">
	<validCheckSum>ANY</validCheckSum>
	<comment>Add KPI C2 authorizations for result, detail result and analytic data APIs</comment>
	<sql splitStatements="true" stripComments="true">

	  <!-- Insert KPI C2 permissions -->
	  INSERT INTO ${database.defaultSchemaName}.AUTH_PERMISSION (co_id, te_nome, te_modulo) VALUES(10097, 'KPI_C2_RESULT_DETAIL', 'GTW');
	  INSERT INTO ${database.defaultSchemaName}.AUTH_PERMISSION (co_id, te_nome, te_modulo) VALUES(10098, 'KPI_C2_DETAIL_RESULT_DETAIL', 'GTW');
	  INSERT INTO ${database.defaultSchemaName}.AUTH_PERMISSION (co_id, te_nome, te_modulo) VALUES(10099, 'KPI_C2_ANALITIC_DATA_DETAIL', 'GTW');

	  <!-- Associate permissions with function 10008 (KPI function) -->
	  INSERT INTO ${database.defaultSchemaName}.AUTH_FUN_AUTH_PERM (co_auth_permission_id, co_auth_function_id) VALUES(10097, 10004);
	  INSERT INTO ${database.defaultSchemaName}.AUTH_FUN_AUTH_PERM (co_auth_permission_id, co_auth_function_id) VALUES(10098, 10004);
	  INSERT INTO ${database.defaultSchemaName}.AUTH_FUN_AUTH_PERM (co_auth_permission_id, co_auth_function_id) VALUES(10099, 10004);

	</sql>
	<rollback>

	  <!-- Remove function-permission associations -->
	  DELETE FROM ${database.defaultSchemaName}.AUTH_FUN_AUTH_PERM WHERE co_auth_permission_id = 10097 AND co_auth_function_id = 10004;
	  DELETE FROM ${database.defaultSchemaName}.AUTH_FUN_AUTH_PERM WHERE co_auth_permission_id = 10098 AND co_auth_function_id = 10004;
	  DELETE FROM ${database.defaultSchemaName}.AUTH_FUN_AUTH_PERM WHERE co_auth_permission_id = 10099 AND co_auth_function_id = 10004;

	  <!-- Remove permissions -->
	  DELETE FROM ${database.defaultSchemaName}.AUTH_PERMISSION WHERE co_id = 10097;
	  DELETE FROM ${database.defaultSchemaName}.AUTH_PERMISSION WHERE co_id = 10098;
	  DELETE FROM ${database.defaultSchemaName}.AUTH_PERMISSION WHERE co_id = 10099;

	</rollback>
  </changeSet>

</databaseChangeLog>
